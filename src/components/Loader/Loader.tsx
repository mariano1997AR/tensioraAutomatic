import { useEffect, useState } from 'react';
import './Loader.css';
import { useTheme } from '../ThemeContext/ThemeContext';


const Loader: React.FC = () => {
    const [progress, setProgress] = useState<number>(0);
    const [loading, setLoading] = useState<boolean>(true);
    const { theme } = useTheme();



    useEffect(() => {
        const interval = setInterval(() => {
            setProgress((prev) => {
                if (prev >= 100) {
                    clearInterval(interval);

                }
                return prev + 1;
            });
        }, 1);

        return () => clearInterval(interval);
    }, []);

    useEffect(() => {
        const timeout = setTimeout(() => {
            setLoading(false);
        }, 3500)

        return () => clearTimeout(timeout);
    }, []);


    return (
        <>
            {loading && <section className="container-load" style={{ background: theme === "dark" ? '#222' : '#F2F4F7' }}>
                <section className='text-center mx-2 logo-responsive items-center gap-2 py-2 logo-loader'>
                    <h1 className='text-center py-4'>Tensiora <span style={{ color: theme === "dark" ? '#FFA55D' : '#60B5FF' }}>Automatic</span></h1>
                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                        width="20.000000pt" height="20.000000pt" viewBox="0 0 512.000000 512.000000"
                        preserveAspectRatio="xMidYMid meet">
                        <metadata>
                            Created by potrace 1.16, written by Peter Selinger 2001-2019
                        </metadata>
                        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                            fill={theme === "dark" ? 'white' : 'black'} stroke="none">
                            <path d="M2645 5105 c-170 -38 -304 -121 -424 -260 -98 -115 -162 -278 -176
-446 l-7 -86 -491 -491 -492 -492 -50 -6 c-126 -15 -281 -82 -382 -164 -114
-92 -198 -215 -249 -365 -25 -72 -28 -94 -28 -225 -1 -160 11 -225 65 -339 31
-67 109 -178 153 -220 l26 -24 0 -649 0 -648 -254 0 c-152 0 -266 -4 -282 -10
-53 -21 -53 -22 -54 -341 l0 -296 23 -21 23 -22 1660 0 c1345 1 1662 3 1676
14 34 25 38 64 38 332 0 294 -3 313 -61 333 -22 8 -285 11 -880 11 l-849 0 0
648 c0 649 0 649 21 668 71 63 155 201 195 319 24 71 27 96 28 217 l1 138 450
449 450 449 87 4 86 3 531 -418 531 -418 0 -108 0 -108 -60 -37 c-92 -57 -165
-159 -189 -266 -6 -27 -11 -229 -11 -513 l0 -469 29 -29 c20 -19 40 -29 60
-29 18 0 105 37 219 94 145 73 191 101 200 121 8 18 12 116 12 330 l0 305 165
0 165 0 0 -302 c0 -220 4 -310 13 -328 9 -18 64 -52 202 -122 208 -106 239
-114 280 -73 l25 24 0 484 c0 412 -2 491 -16 537 -29 97 -91 178 -181 237
l-53 34 0 152 c0 85 -5 180 -11 212 -30 161 -149 291 -308 334 l-59 16 -451
511 -451 511 -4 109 c-5 124 -29 220 -80 322 -101 200 -284 347 -500 402 -94
24 -267 26 -361 5z m313 -179 c229 -61 398 -245 441 -480 34 -183 -27 -366
-168 -507 -109 -110 -228 -165 -377 -176 -330 -24 -622 246 -627 577 -1 103
14 172 59 265 74 157 217 275 384 319 71 19 220 20 288 2z m-764 -1030 c76
-107 219 -220 324 -257 17 -6 32 -14 32 -18 0 -3 -166 -172 -368 -374 l-368
-368 -27 50 c-75 137 -192 250 -334 321 -44 22 -85 40 -91 40 -6 0 -23 5 -38
10 -28 11 -24 15 366 405 l394 394 33 -70 c18 -39 53 -99 77 -133z m1732 -285
c191 -217 343 -396 337 -398 -60 -20 -170 -127 -206 -200 -12 -24 -23 -43 -26
-43 -6 0 -835 651 -858 674 -10 9 3 22 63 61 97 64 191 163 251 266 l46 80 23
-23 c12 -13 178 -200 370 -417z m-2694 -472 c96 -20 212 -83 287 -157 317
-313 197 -836 -226 -983 -75 -26 -213 -35 -295 -20 -174 34 -340 162 -416 322
-46 97 -62 162 -62 259 0 97 16 162 62 259 72 152 227 277 390 317 67 16 191
17 260 3z m3317 -103 c24 -11 59 -39 78 -60 50 -59 63 -117 63 -278 l0 -138
-250 0 -250 0 0 158 c0 175 9 210 70 270 80 80 187 98 289 48z m225 -667 c52
-14 141 -103 155 -155 7 -25 11 -175 11 -412 l0 -372 -80 40 -80 40 0 331 0
330 -25 24 -24 25 -293 0 c-215 -1 -297 -4 -309 -13 -37 -28 -39 -50 -39 -379
l0 -324 -75 -37 c-42 -20 -78 -37 -80 -37 -3 0 -5 166 -5 368 0 404 2 424 60
494 17 20 53 48 82 62 l52 26 305 0 c189 0 321 -4 345 -11z m-3894 -546 c110
-37 282 -43 403 -14 48 11 101 28 117 36 16 8 34 15 40 15 7 0 10 -183 10
-585 l0 -585 -340 0 -340 0 0 586 c0 554 1 586 18 579 9 -3 51 -18 92 -32z
m2360 -1478 l0 -165 -1530 0 -1530 0 0 165 0 165 1530 0 1530 0 0 -165z"/>
                            <path d="M2695 4766 c-186 -59 -306 -219 -307 -408 0 -128 38 -223 122 -307
174 -174 463 -169 623 9 212 237 107 615 -196 705 -61 18 -186 19 -242 1z
m254 -206 c185 -127 137 -398 -80 -450 -150 -36 -299 84 -299 241 0 33 6 74
14 93 21 51 76 107 131 133 42 20 61 23 118 20 56 -4 76 -10 116 -37z"/>
                            <path d="M1995 3741 c-16 -10 -108 -97 -202 -193 l-173 -175 0 -46 c0 -37 5
-49 26 -66 16 -12 41 -21 62 -21 33 0 51 15 225 188 104 103 193 198 198 211
14 35 -7 88 -41 106 -38 20 -59 19 -95 -4z"/>
                            <path d="M995 2975 c-319 -86 -422 -494 -184 -725 247 -239 663 -101 721 240
52 306 -236 567 -537 485z m219 -190 c90 -43 141 -124 141 -225 0 -132 -94
-235 -226 -248 -93 -9 -198 51 -246 140 -24 46 -24 170 0 216 27 49 93 109
140 126 53 20 140 16 191 -9z"/>
                            <path d="M965 1516 c-13 -13 -27 -39 -30 -57 -3 -19 -5 -153 -3 -297 l3 -264
28 -24 c38 -32 90 -32 122 1 l25 24 0 296 0 296 -26 24 c-36 33 -87 33 -119 1z"/>
                        </g>
                    </svg>
                </section>

                <section className="loader-container">
                    <div className="loader-bar" style={{ background: theme === "dark" ? '#FFA55D' : '#60B5FF', width: `${progress}%` }} />
                    <span className="loader-text">{progress}%</span>
                </section>
            </section>}
        </>
    )
}

export default Loader;